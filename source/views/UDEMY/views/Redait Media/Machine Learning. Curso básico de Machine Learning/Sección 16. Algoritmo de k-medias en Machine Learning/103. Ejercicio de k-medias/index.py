# Algoritmos de las k-medias
print("Algoritmos de las k-medias\n")

import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt

from sklearn.datasets import make_blobs

datos = make_blobs(n_samples=200, n_features=2, centers=4)
print(datos)
'''
(array([[ 5.02670820e+00,  6.61352415e-01],
       [ 8.03522913e+00, -8.88948550e+00],
       [ 8.31104489e+00, -3.04605164e-01],
       [ 8.79395099e+00, -1.11101928e+00],
       [ 5.93920888e+00,  1.43921367e+00],
       [-7.77440383e+00,  7.97987820e+00],
       [-6.89533244e+00,  1.05017677e+01],
       [ 7.63545690e+00, -7.16835658e-01],
       [ 3.74245147e+00,  1.91563090e+00],
       [ 5.96352153e+00,  1.93971126e+00],
       [ 7.83093390e+00, -7.85461220e+00],
       [ 4.95207492e+00,  3.76310845e+00],
       [ 9.87523375e+00,  4.14453682e-01],
       [ 3.42296005e+00,  1.78056047e+00],
       [ 9.31718665e+00, -1.25956445e+00],
       [ 9.19082964e+00, -4.34136032e-01],
       [ 7.84187274e+00, -7.62621069e+00],
       [ 9.25481105e+00, -6.45463121e-01],
       [ 8.69129663e+00, -8.21744237e+00],
       [-7.48560577e+00,  8.22858015e+00],
       [ 7.67784366e+00, -8.71966986e+00],
       [-8.96747467e+00,  8.69428974e+00],
       [ 5.04597587e+00,  3.98447337e-01],
       [-7.99605693e+00,  9.22802863e+00],
       [ 6.01248997e+00,  2.48448973e+00],
       [ 8.07656930e+00, -1.91524428e+00],
       [ 8.12809821e+00,  5.93960830e-02],
       [ 8.64678088e+00, -7.32237159e+00],
       [ 4.30631665e+00,  2.14021802e+00],
       [-7.34807882e+00,  9.34620518e+00],
       [ 2.54958827e+00,  1.86718517e+00],
       [ 4.29259518e+00,  1.87877416e+00],
       [ 9.76024631e+00, -1.12417599e+00],
       [ 8.15563859e+00, -8.93673044e+00],
       [ 7.46629382e+00, -1.13124729e+01],
       [ 5.66797527e+00,  1.24553338e+00],
       [-6.97196956e+00,  9.54125018e+00],
       [ 7.48475389e+00, -7.46658898e+00],
       [ 8.60849833e+00, -8.96832121e+00],
       [-9.08663589e+00,  8.36129456e+00],
       [-9.66043726e+00,  8.89299371e+00],
       [ 6.86325595e+00, -6.59642173e-01],
       [ 5.58561607e+00,  1.08096801e+00],
       [ 5.37655467e+00,  1.47400731e+00],
       [-6.74647616e+00,  9.78490776e+00],
       [-7.01209240e+00,  9.70206963e+00],
       [ 6.62284309e+00, -8.50178498e+00],
       [ 6.45896655e+00, -8.89382817e+00],
       [-7.48867889e+00,  9.64871101e+00],
       [ 7.96997705e+00, -1.11620352e+00],
       [ 9.74970466e+00, -6.50522642e-01],
       [ 4.63574983e+00,  8.36396314e-01],
       [ 6.21019134e+00,  2.29193193e+00],
       [-8.65854987e+00,  8.31415835e+00],
       [-9.28152206e+00,  8.97044115e+00],
       [ 4.23020835e+00,  3.35404903e+00],
       [-7.07623897e+00,  9.09313701e+00],
       [ 8.65808875e+00, -1.12601443e+01],
       [ 9.35234842e+00,  3.84905182e-01],
       [-8.37190931e+00,  8.90158851e+00],
       [ 7.37855818e+00, -9.53564970e+00],
       [ 3.27425047e+00,  1.05548657e+00],
       [ 9.11469906e+00, -8.09606877e+00],
       [ 3.94304558e+00,  1.36398802e+00],
       [ 6.49284345e+00, -8.63668551e+00],
       [ 3.53403975e+00,  9.84351790e-01],
       [ 7.39677739e+00, -1.05991251e+01],
       [-7.61483766e+00,  9.36300247e+00],
       [ 9.07809845e+00, -9.39229676e+00],
       [ 5.54059978e+00,  1.32545346e+00],
       [ 5.04186699e+00,  2.91986025e+00],
       [ 8.30300147e+00, -4.21747911e-01],
       [ 9.13983195e+00, -3.11249691e-05],
       [ 9.94841395e+00, -1.77641084e+00],
       [-8.43469116e+00,  7.08219878e+00],
       [ 5.45799582e+00,  2.22286126e-01],
       [ 5.10010680e+00,  2.65953803e+00],
       [-7.75095074e+00,  7.45809251e+00],
       [-7.59568771e+00,  8.15879206e+00],
       [ 1.00409440e+01, -8.67698454e+00],
       [ 7.25475765e+00, -9.51226340e-01],
       [ 1.04263851e+01, -6.71161919e-01],
       [ 7.14138386e+00, -7.88952005e+00],
       [-7.28111948e+00,  9.21367434e+00],
       [ 1.06788876e+01, -7.63994691e+00],
       [-8.24029130e+00,  8.35923000e+00],
       [ 4.67884805e+00,  2.98129049e+00],
       [ 9.43073594e+00, -1.19474657e+00],
       [ 3.44034297e+00,  1.15360981e+00],
       [ 7.97788324e+00,  2.14603943e-01],
       [ 5.09437100e+00,  2.15139919e+00],
       [ 4.39303443e+00,  4.83594666e-01],
       [ 9.20804097e+00, -1.37108657e+00],
       [ 9.37369762e+00,  9.26065868e-02],
       [-8.92705555e+00,  8.24813725e+00],
       [ 7.06660018e+00, -8.66997749e+00],
       [ 8.72083623e+00, -7.63765981e+00],
       [ 4.50176174e+00,  1.78621665e+00],
       [-7.67771700e+00,  9.62726894e+00],
       [ 8.45259843e+00, -6.70151244e-01],
       [ 5.88623508e+00,  2.56987684e+00],
       [ 7.93944995e+00, -8.24849471e+00],
       [ 4.82312467e+00, -8.59942023e+00],
       [ 8.17759891e+00, -1.24421736e+00],
       [-8.25597166e+00,  9.25912056e+00],
       [ 1.01042042e+01, -8.37675101e-01],
       [ 8.26513631e+00, -7.14884613e+00],
       [ 4.07798809e+00,  1.89964440e+00],
       [-8.06876430e+00,  9.29519054e+00],
       [-8.68574116e+00,  7.59399663e+00],
       [ 9.37902348e+00, -7.54110931e-01],
       [ 6.95508376e+00,  1.10306836e+00],
       [ 7.40438080e+00, -8.00316301e+00],
       [ 8.84960145e+00, -1.38716963e+00],
       [ 4.48507781e+00,  1.16408955e+00],
       [-8.82934419e+00,  9.51389548e+00],
       [ 8.26010553e+00, -9.56479974e+00],
       [-8.62135098e+00,  9.84399260e+00],
       [ 3.75659256e+00,  1.34114950e+00],
       [ 9.01110174e+00,  1.07032851e+00],
       [-8.61867629e+00,  8.59764388e+00],
       [ 8.58545710e+00,  2.85975712e-02],
       [ 1.08631099e+01, -1.28360416e+00],
       [-7.47587771e+00,  8.60326866e+00],
       [-7.51449782e+00,  9.68043289e+00],
       [ 9.06172265e+00, -7.36683332e+00],
       [ 7.51129515e+00, -7.43863407e+00],
       [ 6.34335169e+00, -8.35806765e+00],
       [ 7.43096871e+00,  2.60430559e-01],
       [ 6.64145576e+00,  1.62423309e+00],
       [ 4.77143990e+00,  1.29900328e+00],
       [ 8.64726201e+00, -1.47076112e+00],
       [ 6.72113888e+00, -7.41177130e+00],
       [ 8.36504794e+00,  5.34336656e-01],
       [-7.13250470e+00,  8.72529102e+00],
       [ 4.85189222e+00,  2.01313081e+00],
       [ 3.46285228e+00,  3.58792392e+00],
       [ 7.45150281e+00, -8.92961135e+00],
       [-8.24143947e+00,  9.08403956e+00],
       [ 3.23473925e+00,  1.69565688e+00],
       [ 7.82861778e+00, -7.16811527e+00],
       [ 8.26221977e+00, -1.23082264e+00],
       [ 7.21111653e+00, -7.13205049e+00],
       [ 9.48555922e+00, -5.38938041e-02],
       [-6.96091359e+00,  5.52939273e+00],
       [-7.38616513e+00,  9.92075240e+00],
       [ 5.43346732e+00,  1.27941525e+00],
       [ 1.01244091e+01, -9.63803522e+00],
       [ 7.71031205e+00, -8.95792809e-01],
       [-9.09008692e+00,  8.83238131e+00],
       [ 4.15208110e+00,  2.57824999e+00],
       [ 5.36316606e+00,  2.70851460e+00],
       [ 8.56887875e+00, -7.55775705e+00],
       [-8.50137121e+00,  9.66316475e+00],
       [ 8.11818316e+00,  9.46912415e-01],
       [ 4.82341488e+00,  2.68858468e+00],
       [ 8.49474193e+00, -3.75338732e-01],
       [-7.30842527e+00,  9.13133238e+00],
       [-7.18448111e+00,  8.89734995e+00],
       [-7.75139185e+00,  7.75207975e+00],
       [ 8.91967106e+00, -9.27844673e+00],
       [-8.11558957e+00,  8.56651766e+00],
       [ 8.37974361e+00, -8.65261462e+00],
       [ 7.86591915e+00, -7.74177002e+00],
       [ 7.76630610e+00, -8.74173125e+00],
       [-7.81122177e+00,  8.16220514e+00],
       [ 3.42529929e+00,  2.80761300e-01],
       [ 7.62616372e+00,  1.55657314e+00],
       [-7.18858529e+00,  9.24817620e+00],
       [ 8.15331832e+00,  1.69782593e+00],
       [ 4.07252072e+00,  1.33599706e+00],
       [ 7.30216240e+00, -1.44206284e+00],
       [ 2.92474926e+00,  1.58857591e+00],
       [-8.68410403e+00,  8.13245301e+00],
       [ 9.66057139e+00, -1.41305073e+00],
       [ 7.72492208e+00, -7.45831801e+00],
       [ 4.20996145e+00,  1.40168165e+00],
       [ 7.02011910e+00, -1.32713553e+00],
       [ 8.86822320e+00, -8.23551763e+00],
       [ 8.32564090e+00, -7.92350612e-01],
       [ 1.12919625e+01,  1.11915232e+00],
       [ 6.86285012e+00, -8.11296636e+00],
       [ 8.53093179e+00, -7.86937771e+00],
       [-7.42992924e+00,  8.32415055e+00],
       [ 7.25337296e+00, -8.47422638e+00],
       [ 9.22867962e+00, -3.79579348e-01],
       [-8.53767797e+00,  1.09594682e+01],
       [ 9.51115897e+00,  7.03475591e-01],
       [ 8.76614982e+00,  3.25172112e-01],
       [ 8.57907521e+00, -7.23698183e+00],
       [ 4.92211307e+00,  9.60768292e-01],
       [ 4.10119927e+00,  1.78311700e+00],
       [-8.46727444e+00,  7.21034662e+00],
       [-6.09357395e+00,  9.27729934e+00],
       [-8.94554336e+00,  9.26028638e+00],
       [ 9.09570669e+00, -7.97611418e+00],
       [ 1.08344257e+01, -2.25789905e+00],
       [ 6.94683062e+00, -7.49998781e+00],
       [ 4.68278637e+00,  5.45422363e-01],
       [ 7.83317493e+00, -9.53162301e+00]]), array([3, 1, 2, 2, 3, 0, 0, 2, 3, 3, 1, 3, 2, 3, 2, 2, 1, 2, 1, 0, 1, 0,
       3, 0, 3, 2, 2, 1, 3, 0, 3, 3, 2, 1, 1, 3, 0, 1, 1, 0, 0, 2, 3, 3,
       0, 0, 1, 1, 0, 2, 2, 3, 3, 0, 0, 3, 0, 1, 2, 0, 1, 3, 1, 3, 1, 3,
       1, 0, 1, 3, 3, 2, 2, 2, 0, 3, 3, 0, 0, 1, 2, 2, 1, 0, 1, 0, 3, 2,
       3, 2, 3, 3, 2, 2, 0, 1, 1, 3, 0, 2, 3, 1, 1, 2, 0, 2, 1, 3, 0, 0,
       2, 3, 1, 2, 3, 0, 1, 0, 3, 2, 0, 2, 2, 0, 0, 1, 1, 1, 2, 3, 3, 2,
       1, 2, 0, 3, 3, 1, 0, 3, 1, 2, 1, 2, 0, 0, 3, 1, 2, 0, 3, 3, 1, 0,
       2, 3, 2, 0, 0, 0, 1, 0, 1, 1, 1, 0, 3, 2, 0, 2, 3, 2, 3, 0, 2, 1,
       3, 2, 1, 2, 2, 1, 1, 0, 1, 2, 0, 2, 2, 1, 3, 3, 0, 0, 0, 1, 2, 1,
       3, 1]))
'''

print()

print(datos[1])
'''
[2 2 1 2 0 0 1 0 2 1 3 0 3 0 2 3 0 2 1 0 3 3 0 0 0 3 3 0 3 3 2 1 0 0 3 1 0
 3 2 1 3 1 3 1 0 2 3 3 2 0 2 2 3 1 0 0 2 0 2 0 3 2 2 0 1 0 0 1 1 3 1 2 2 0
 2 2 2 3 2 1 0 1 0 1 3 0 0 2 3 1 1 1 3 1 2 1 3 0 3 2 1 0 3 1 1 2 1 2 0 0 0
 0 3 0 2 2 3 1 0 2 1 1 0 0 1 1 2 1 2 2 0 2 0 3 1 2 3 1 1 2 2 2 3 2 3 2 3 0
 3 1 1 0 1 2 0 0 3 3 3 3 1 3 1 0 2 1 2 2 3 3 1 3 1 3 2 1 1 0 3 2 3 2 1 3 3
 2 2 1 0 0 3 0 2 1 1 3 0 3 1 3]
'''

print()

plt.scatter(datos[0][:, 0], datos[0][:, 1])
plt.show()

from sklearn.cluster import KMeans

modelo = KMeans(n_clusters=4)
modelo.fit(datos[0])

print(modelo.cluster_centers_)
'''
[[ 5.06051169 -9.18553687]
 [ 1.02402865  1.78254636]
 [ 1.93320201 -4.22763626]
 [ 4.45760341  4.54714181]]
'''

print()

print(modelo.labels_)
'''
[0 1 3 1 1 0 3 0 0 2 0 3 1 3 0 0 2 2 2 0 2 2 2 1 2 3 0 1 3 2 0 2 0 1 3 0 0
 0 0 1 1 2 3 0 0 3 2 1 2 1 3 0 2 0 3 1 1 1 1 0 2 0 0 3 3 3 2 2 3 2 3 2 1 0
 2 0 0 1 1 2 2 1 0 2 3 3 3 0 2 1 1 0 0 3 0 2 2 3 0 3 3 3 2 1 3 1 2 0 1 1 2
 3 1 1 3 3 0 0 3 1 0 3 1 3 3 1 1 1 3 0 3 2 1 1 3 1 0 2 1 1 3 0 3 2 0 2 1 2
 0 1 3 1 2 2 3 2 0 3 1 3 0 0 2 2 0 0 3 0 1 2 3 2 2 2 2 0 2 1 0 2 3 1 0 0 1
 3 3 2 1 1 2 3 3 1 1 1 2 3 2 3]
'''

print()

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 4))

ax1.scatter(datos[0][:, 0], datos[0][:, 1], c=modelo.labels_)
ax1.set_title('Algoritmo de k-medias')

ax2.scatter(datos[0][:, 0], datos[0][:, 1], c=datos[1])
ax2.set_title('Datos originales')

plt.show()